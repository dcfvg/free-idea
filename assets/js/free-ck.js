$(function(){function e(){$("img.draggable").each(function(e,t){var n=Math.floor(Math.random()*6e3),r=Math.floor(Math.random()*4e3);$(t).css({position:"absolute",left:n,top:r})})}function t(e){var t=$.post(o,{query:e});t.done(function(e){e=JSON.parse(e);l.append('<img class="draggable" src="'+e.part+'">').find("img:last-child()").css({position:"absolute",left:u.x,top:u.y}).draggable({disabled:!0}).draggable("enable");console.log(e)})}function n(){l.find("img:last-child()").remove()}function r(e){var t=$.post(o,{blacklist:e});t.done(function(e){e=JSON.parse(e);console.log(e)})}function i(){$("#select").remove();l.append('<div id="select"></div>');$("#select").css({position:"absolute",left:u.x,top:u.y})}function s(){}var o="call.php",u={x:-1,y:-1},a={x:-1,y:-1},f=!1,l=$("#drawZone");l.mousedown(function(e){u.x=e.pageX;u.y=e.pageY;f&&i()}).mousemove(function(e){f&&$("#select").css({position:"absolute",width:e.pageX-u.x,height:e.pageY-u.y})}).mouseup(function(e){a.x=e.pageX;a.y=e.pageY;f&&t(a.x-u.x+"x"+(a.y-u.y));$("#select").remove()});$("html").keydown(function(e){e.which==32&&f==0&&(f=!0)}).keyup(function(e){e.which==32&&(f=!1)}).keypress(function(e){e.which==114&&n();e.which==113&&t(a.x-u.x+"x"+(a.y-u.y));if(e.which==98){r(l.find("img:last-child()").attr("src"));n()}})});